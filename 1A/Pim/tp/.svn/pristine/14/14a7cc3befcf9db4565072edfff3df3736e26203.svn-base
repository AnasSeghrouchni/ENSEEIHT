% Validation de http://hpxc/cregut.svn.enseeiht.fr/2021/1sn/pim/tps/aseghrou/tp10
% Run on 2021-11-20 14:19:22.706155


################################################################################
# Modification des fichiers fournis
################################################################################


================================================================================
## Fichiers qui NE devaient PAS être modifiés
================================================================================

* Fichier alea.adb non modifié... ok
* Fichier alea.ads non modifié... ok
* Fichier exemple_alea.adb non modifié... ok
* Fichier exemple_unbounded_string.adb non modifié... ok
* Fichier sda_exceptions.ads non modifié... ok
* Fichier test_lca.adb non modifié... ok

================================================================================
## Fichiers qui DEVAIENT être modifiés
================================================================================

* Fichier lca_sujet.adb modifié... ok
* Fichier lca.ads modifié... ok
* Fichier lca.adb modifié... ok


################################################################################
# Nettoyer
################################################################################

* Running gnatclean... ok


################################################################################
# Exercice 1
################################################################################


================================================================================
## Modifications de lca.ads
================================================================================

* Comparaison de lca.ads et fournis/lca.ads... différents

   | -- AVEC_AFFICHER_DEBUG START DELETE                                                                <
   |         -- Afficher la Sda en révélant sa structure interne.                                       <
   |         --generic                                                                                  <
   |                 --with procedure Afficher_Cle (Cle : in T_Cle);                                    <
   |                 --with procedure Afficher_Donnee (Donnee : in T_Donnee);                           <
   |         --procedure Afficher_Debug (Sda : in T_LCA);                                               <
   |                                                                                                    <
   |                                                                                                    <
   | -- AVEC_AFFICHER_DEBUG STOP DELETE                                                                 <
   |     type T_Cellule;                                                                                <
   |     type T_LCA is access  T_Cellule;                                                               <
   |     type T_Cellule is record                                                                       <
   |         Cle : T_Cle;                                                                               <
   |         Donnes: T_Donnee;                                                                          <
   |         Prochain : T_LCA;                                                                          <
   |     end record;                                                                                    <
   | end LCA;                                                                                           |          -- TODO : à compléter
   |                                                                                                    >  end LCA;


================================================================================
## Exécution de lca_sujet.adb
================================================================================

* Compilation de lca_sujet.adb... ok
* ./lca_sujet... ok
* valgrind ./lca_sujet... ERREUR

  ! ==1508261== Memcheck, a memory error detector
  ! ==1508261== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
  ! ==1508261== Using Valgrind-3.17.0 and LibVEX; rerun with -h for copyright info
  ! ==1508261== Command: ./lca_sujet
  ! ==1508261== 
  ! ==1508261== 
  ! ==1508261== HEAP SUMMARY:
  ! ==1508261==     in use at exit: 160 bytes in 4 blocks
  ! ==1508261==   total heap usage: 4 allocs, 0 frees, 160 bytes allocated
  ! ==1508261== 
  ! ==1508261== 160 (48 direct, 112 indirect) bytes in 1 blocks are definitely lost in loss record 4 of 4
  ! ==1508261==    at 0x4843839: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
  ! ==1508261==    by 0x4AE1FEE: __gnat_malloc (in /usr/lib/x86_64-linux-gnu/libgnat-10.so)
  ! ==1508261==    by 0x4B0F50C: system__pool_global__allocate (in /usr/lib/x86_64-linux-gnu/libgnat-10.so)
  ! ==1508261==    by 0x4B1F176: system__storage_pools__subpools__allocate_any_controlled (in /usr/lib/x86_64-linux-gnu/libgnat-10.so)
  ! ==1508261==    by 0x10C585: lca_sujet__lca_string__enregistrer__P83b.10 (lca.adb:44)
  ! ==1508261==    by 0x10C3A9: lca_sujet__lca_string__enregistrer.6 (lca.adb:35)
  ! ==1508261==    by 0x10BDA5: _ada_lca_sujet (lca_sujet.adb:27)
  ! ==1508261==    by 0x10BB3C: main (b~lca_sujet.adb:288)
  ! ==1508261== 
  ! ==1508261== LEAK SUMMARY:
  ! ==1508261==    definitely lost: 48 bytes in 1 blocks
  ! ==1508261==    indirectly lost: 112 bytes in 3 blocks
  ! ==1508261==      possibly lost: 0 bytes in 0 blocks
  ! ==1508261==    still reachable: 0 bytes in 0 blocks
  ! ==1508261==         suppressed: 0 bytes in 0 blocks
  ! ==1508261== 
  ! ==1508261== For lists of detected and suppressed errors, rerun with: -s
  ! ==1508261== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)


================================================================================
## Exécution de test_lca.adb
================================================================================

* Compilation de test_lca.adb... ok

  | test_lca.adb:257:17: warning: variable "Inutile" is assigned but never read
  | test_lca.adb:280:35: warning: formal parameter "Cle" is not referenced

* ./test_lca... ok
* valgrind ./test_lca... ERREUR

  ! ==1508275== Memcheck, a memory error detector
  ! ==1508275== Copyright (C) 2002-2017, and GNU GPL'd, by Julian Seward et al.
  ! ==1508275== Using Valgrind-3.17.0 and LibVEX; rerun with -h for copyright info
  ! ==1508275== Command: ./test_lca
  ! ==1508275== 
  ! ==1508275== 
  ! ==1508275== HEAP SUMMARY:
  ! ==1508275==     in use at exit: 1,312 bytes in 28 blocks
  ! ==1508275==   total heap usage: 169 allocs, 141 frees, 12,672 bytes allocated
  ! ==1508275== 
  ! ==1508275== 1,312 (48 direct, 1,264 indirect) bytes in 1 blocks are definitely lost in loss record 24 of 24
  ! ==1508275==    at 0x4843839: malloc (in /usr/libexec/valgrind/vgpreload_memcheck-amd64-linux.so)
  ! ==1508275==    by 0x4AE1FEE: __gnat_malloc (in /usr/lib/x86_64-linux-gnu/libgnat-10.so)
  ! ==1508275==    by 0x4B0F50C: system__pool_global__allocate (in /usr/lib/x86_64-linux-gnu/libgnat-10.so)
  ! ==1508275==    by 0x4B1F176: system__storage_pools__subpools__allocate_any_controlled (in /usr/lib/x86_64-linux-gnu/libgnat-10.so)
  ! ==1508275==    by 0x10DD16: test_lca__lca_string_integer__enregistrer__P321b.7 (lca.adb:44)
  ! ==1508275==    by 0x10DB35: test_lca__lca_string_integer__enregistrer.6 (lca.adb:35)
  ! ==1508275==    by 0x10F056: test_lca__construire_exemple_sujet.3 (test_lca.adb:77)
  ! ==1508275==    by 0x10F434: test_lca__tester_supprimer_inverse.26 (test_lca.adb:115)
  ! ==1508275==    by 0x10D33E: _ada_test_lca (test_lca.adb:372)
  ! ==1508275==    by 0x10CBEC: main (b~test_lca.adb:288)
  ! ==1508275== 
  ! ==1508275== LEAK SUMMARY:
  ! ==1508275==    definitely lost: 48 bytes in 1 blocks
  ! ==1508275==    indirectly lost: 1,264 bytes in 27 blocks
  ! ==1508275==      possibly lost: 0 bytes in 0 blocks
  ! ==1508275==    still reachable: 0 bytes in 0 blocks
  ! ==1508275==         suppressed: 0 bytes in 0 blocks
  ! ==1508275== 
  ! ==1508275== For lists of detected and suppressed errors, rerun with: -s
  ! ==1508275== ERROR SUMMARY: 1 errors from 1 contexts (suppressed: 0 from 0)



################################################################################
# Nettoyer
################################################################################

* Running gnatclean... ok

<!-- vi: set ts=8: -->
